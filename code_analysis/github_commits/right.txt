>>>>>>>>>>>>>>>>>>>> apache/zookeeper 75f9781ecc3cde9fa5a032fa8cfa8c79b69ef879 676612eb21fc081db1710611
>>>>>>>>>>>>>>>>>>>> 文件名: zookeeper-server/src/main/java/org/apache/zookeeper/ClientCnxn.java
ZOOKEEPER-4819: Fix can't seek for writable tls server if connected to readonly server

Reviewers: kezhuw
Author: luoxiner
Closes #2200 from luoxiner/ZOOKEEPER-4819
<<<<<<<<<<<<<<<<<<<<
>>>>>>>>>>>>>>>>>>>> apache/zookeeper bc9afbf8ef1bc6156643d3d05c87fcf8411e9d8f 676612eb21fc081db1710624
>>>>>>>>>>>>>>>>>>>> 文件名: zookeeper-server/src/main/java/org/apache/zookeeper/server/ZooKeeperServer.java
ZOOKEEPER-4712: Fix partially shutdown of ZooKeeperServer and its processors

Reviewers: anmolnar, kezhuw, kezhuw, kezhuw
Author: jonmv
Closes #2154 from jonmv/jonmv/ZOOKEEPER-4541-take-2
<<<<<<<<<<<<<<<<<<<<
>>>>>>>>>>>>>>>>>>>> apache/zookeeper 3e2d6f3436962cd4a0445bc6c22f583e425d7ced 676612eb21fc081db171062e
>>>>>>>>>>>>>>>>>>>> 文件名: zookeeper-server/src/test/java/org/apache/zookeeper/test/QuorumTest.java
ZOOKEEPER-4747: Add synchronous sync to ease synchronous call chains (#2068)

Previously, there is no synchronous `sync` so client has to convert
asynchronous `sync` a bit to fit synchronous call chains. This is
apparently unfriendly.

Besides above, in absent of ZOOKEEPER-22, we can't issue a fire and
forget asynchronous `sync` to gain strong consistent. So it becomes
crucial for client to have a convenient synchronous `sync`.

Refs: ZOOKEEPER-1167, ZOOKEEPER-4747
>>>>>>>>>>>>>>>>>>>> 文件名: zookeeper-server/src/test/java/org/apache/zookeeper/test/SessionTest.java
ZOOKEEPER-4747: Add synchronous sync to ease synchronous call chains (#2068)

Previously, there is no synchronous `sync` so client has to convert
asynchronous `sync` a bit to fit synchronous call chains. This is
apparently unfriendly.

Besides above, in absent of ZOOKEEPER-22, we can't issue a fire and
forget asynchronous `sync` to gain strong consistent. So it becomes
crucial for client to have a convenient synchronous `sync`.

Refs: ZOOKEEPER-1167, ZOOKEEPER-4747
<<<<<<<<<<<<<<<<<<<<
>>>>>>>>>>>>>>>>>>>> apache/zookeeper 31c7a7e4c2b3b71549a06f442f8a4c5e9f03a6df 676612eb21fc081db1710644
>>>>>>>>>>>>>>>>>>>> 文件名: zookeeper-server/src/test/java/org/apache/zookeeper/server/quorum/Zab1_0Test.java
ZOOKEEPER-4723. Cleanup more in-place bytebuffer manipulations (#2036)

Signed-off-by: tison <wander4096@gmail.com>
<<<<<<<<<<<<<<<<<<<<
>>>>>>>>>>>>>>>>>>>> apache/zookeeper e10bf869eae8cd205d7a0a43395e4cf14c498587 676612eb21fc081db1710649
>>>>>>>>>>>>>>>>>>>> 文件名: zookeeper-server/src/test/java/org/apache/zookeeper/server/ZooKeeperServerBeanTest.java
ZOOKEEPER-4780: Delegate temp directory creation to Junit in tests.

ZOOKEEPER-4780: Delegate temp directory creation to Junit in tests.
Use Junit @TempDir annotation to manage temp directory for tests.
Use TempDir annotation for few more tests.
Remove unusedimports
There is a test which fails on the CI, but when I reran it local it passes. test=TruncateTest
Revert TruncateTest
Address comments
Make sure the temp directory scope is not affected.
fix for ZKClientConfigTest
Reviewers: ctubbsii, eolivelli
Author: muthu90tech
Closes #2100 from muthu90tech/ZOOKEEPER-4780
<<<<<<<<<<<<<<<<<<<<
>>>>>>>>>>>>>>>>>>>> apache/zookeeper e8b2fbeb101e22378aa47df291cc9ca6e58e1e8d 676612ee21fc081db171068a
>>>>>>>>>>>>>>>>>>>> 文件名: zookeeper-server/src/test/java/org/apache/zookeeper/RemoveWatchesTest.java
ZOOKEEPER-4472: Remove persistent watches individually  (#2006)

* ZOOKEEPER-4472: Remove persistent watches individually

ZOOKEEPER-4466 supports different watch modes one same path, but there
are no corresponding `WatcherType`s for persistent watches. Client has
to resort to `WatcherType.Any` to remove them. This could accidently
interrupt other watches.

This PR adds `WatcherType.Persistent` and `WatcherType.PersistentRecursive`
to remove persistent watches individually.

* Assert removing WatcherType::Data from AddWatchMode::Persistent is impossible

* fixup! Assert removing WatcherType::Data from AddWatchMode::Persistent is impossible
<<<<<<<<<<<<<<<<<<<<
>>>>>>>>>>>>>>>>>>>> apache/zookeeper 2e9c3f3ceda90aeb9380acc87b253bf7661b7794 676612ee21fc081db171069d
>>>>>>>>>>>>>>>>>>>> 文件名: zookeeper-server/src/test/java/org/apache/zookeeper/test/StaticHostProviderTest.java
[ZOOKEEPER-4647] Tests don't pass on JDK20 because we try to mock InetAddress (#1959)

- upgrade Mockito to 4.9.0
- use BurningWave DNS mock tools
<<<<<<<<<<<<<<<<<<<<
>>>>>>>>>>>>>>>>>>>> apache/zookeeper d32ec677f8fd00a367b305e1ae8abf127700511c 676612f021fc081db17106e6
>>>>>>>>>>>>>>>>>>>> 文件名: zookeeper-contrib/zookeeper-contrib-zooinspector/src/main/java/org/apache/zookeeper/inspector/gui/nodeviewer/NodeViewerData.java
ZOOKEEPER-4291: ZooInspector has very high latency when operating against remote clusters

Apache Jira Issue: https://issues.apache.org/jira/browse/ZOOKEEPER-4291
Zookeeper Contribution Guidelines: https://cwiki.apache.org/confluence/display/zookeeper/howtocontribute

This is a fairly substantial change and I will also send a note on the zookeeper-dev mailing list to start a discussion in case there are more questions/comments.

The existing version of ZooInspector had an extremely short cache retention time combined with tying high frequency UI operations to network calls which resulted in almost unusable latency when using ZooInspector to talk to a Zookeeper cluster over a network.  This change refactors the tree view to move network calls onto background threads in the TreeModel while keeping the UI itself responsive and only reloading data on request after initial node expansion.

In general, I think these changes take the tool from being virtually unusable when talking to remote clusters to being performant enough and responsive enough to be useful in most cases.

Some other related highlights include:
- Made getNumChildren() use the NodeCache (it wasn't previously)
- Remove network calls getting triggered during UI redraw animations such as using scroll bars or resizing the window
- Addition of a mouse spinner animation when work is in progress
- Addition of the number of child nodes in parentheses after the node name on the UI
- Move Add/Delete node logic to be encapsulated in TreeViewer logic (and remove separate Add/Delete NodeAction classes)
- Addition of a right-click menu item to refresh a selected subtree (previously this was only doable for the entire tree)
- Fixed the broken "Node Viewer Settings" icon and button (it previously had no icon set and didn't show on the UI)
- Fixed the broken "About" button (it previously was failing to find the about.html file)
- Fixed a number of Javadoc-related build warnings
- Fixed a number of naming typos (e.g. NodeVeiwers -> NodeViewers)
- Removed some dead/unused code

Testing
- The build succeeds, though ZooInspector currently has no unit tests.  I did test it fairly extensively with some remote clusters I have available.
<img width="974" alt="zooinspector-helix-screenshot" src="https://user-images.githubusercontent.com/33364712/148818936-065d19fc-e06b-4b00-8cae-374cd8ac82a0.png">

I have attached a screenshot of the updated version of ZooInspector (examining an Apache Helix cluster in Zookeeper).

Author: Brent Nash <brent.nash@crowdstrike.com>

Reviewers: Enrico Olivelli <eolivelli@apache.org>, Mate Szalay-Beko <symat@apache.org>

Closes #1796 from brentwritescode/ZOOKEEPER-4291
<<<<<<<<<<<<<<<<<<<<
>>>>>>>>>>>>>>>>>>>> apache/zookeeper 957f8fc0afbeca638f13f6fb739e49a921da2b9d 676612f021fc081db17106ed
>>>>>>>>>>>>>>>>>>>> 文件名: zookeeper-server/src/test/java/org/apache/zookeeper/server/NettyServerCnxnTest.java
ZOOKEEPER-3988: rg.apache.zookeeper.server.NettyServerCnxn.receiveMessage throws NullPointerException

Modifications:
- prevent the NPE, the code that throws NPE is only to record some metrics for non TLS requests

Related to:
- apache/pulsar#11070
- https://github.com/pravega/zookeeper-operator/issues/393

Author: Enrico Olivelli <eolivelli@apache.org>

Reviewers: Nicolo² Boschi <boschi1997@gmail.com>, Andor Molnar <andor@apache.org>, Mate Szalay-Beko <symat@apache.org>

Closes #1798 from eolivelli/fix/ZOOKEEPER-3988-npe
<<<<<<<<<<<<<<<<<<<<
